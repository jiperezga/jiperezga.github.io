---
layout: post
title: "Clase 05"
main-class: 'clase'
permalink: /ProbabilidadeInferencia/PeIE:title.html
tags:

introduction: |
  Resúmenes numéricos. <br/>
  Resúmenes tabulares. <br/>
  Resúmenes gráficos.
header-includes:
   - \usepackage{amsmath,amssymb,amsthm,amsfonts}
   - \usepackage[sectionbib]{natbib}
   - \usepackage[hidelinks]{hyperref}
output:
  md_document:
    variant: markdown_strict+backtick_code_blocks+autolink_bare_uris+ascii_identifiers+tex_math_single_backslash
    preserve_yaml: TRUE
always_allow_html: yes   
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding,
  output_dir = "../../ProbabilidadeInferencia/_posts/", output_format = "all")})
bibliography: "../../referencias.bib"
csl: "../../apa.csl"
---

```{r knitr_init, echo=FALSE, cache=FALSE}
library(knitr)
## Global options
opts_chunk$set(echo=TRUE,
               cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE,
               fig.path = paste0("../../ProbabilidadeInferencia/images/", "Clase05"),
               cache.path = "../../ProbabilidadeInferencia/cache/",
               cache = FALSE)

```

## Resumen numéricos
Una parte importante de la estadística descriptiva, son las medidas estadísticas ya explicadas en la [Clase 03](../../ProbabilidadeInferencia/PeIEClase03.html){:target="_blank"} y [Clase 04](../../ProbabilidadeInferencia/PeIEClase04.html){:target="_blank"}, y aún más importante, es buscar la más adecuada para presentar dichas medidas.

Una alternativa es mediante resúmenes numéricos, los cual permiten observar el comportamiento de un conjunto de observaciones mediante diferentes medidas numéricas, que se presentan de forma simple y ordenada.

Entre las diferentes funciones que permiten realizar resúmenes numéricos en <tt>R</tt>, se destaca la función `numSummary()` de la librería `RcmdrMisc` y la función `describe()` de la librería `psych`, que presentan el resúmen de variables tipo numéricas. 

Para ilustrar el manejo de estas funciones, se empleara la base de datos de [Agricultura de India](https://github.com/jiperezga/jiperezga.github.io/raw/master/Dataset/AgriculturaIndia.xlsx){:target="_blank"}, la cual contiene la información sobre la producción de cultivos agrícolas en la India. La base de datos contiene el tipo de cultivo, el estado en el cual se realiza el cultivo, los costos y la producción obtenida.

```{r}
### Instalar y cargar librerías
# install.packages(c("readxl", "XLConnect"), dependencies = T) # Instala librerías
library(readxl) # Carga librería
library(XLConnect) # Para descargar archivos online de forma temporal

### Crea archivo temporal para cargar archivo online
temp <- tempfile(fileext = ".xlsx") 
dataURL <- "https://github.com/jiperezga/jiperezga.github.io/raw/master/Dataset/AgriculturaIndia.xlsx"
download.file(dataURL, destfile=temp, mode='wb')

### Carga archivo
datos <- read_xlsx(temp) # Carga la base de datos
# datos <- read_xlsx(file.choose()) # para buscar archivo xlsx guardado en el PC

str(datos) # Muestra la estructura de la base de datos

### Transformar variables
datos$Crop <- factor(datos$Crop)
datos$State <- factor(datos$State)

# install.packages("RcmdrMisc") # Instala librería RcmdrMisc
library(RcmdrMisc) # Carga librería RcmdrMisc

# Forma básica numSummary 
numSummary(datos$`Yield (Quintal/ Hectare)`) 
# Forma avanzada numSummary
numSummary(datos$`Yield (Quintal/ Hectare)`, statistics = c("mean", "sd", "se", "IQR", "quantiles", "cv", "skewness", "kurtosis"), type = "3", quantiles = c(0, .25, .5, .75, 1)) 

library(psych) # Carga librería pysch
# Forma básica pysch
describe(datos$`Yield (Quintal/ Hectare)`)
# Forma avanzada pysch
describe(datos$`Yield (Quintal/ Hectare)`, ranges = TRUE, trim = 0.2, type = 3, quant = c(0.25, 0.75), IQR = TRUE)
```

También es posible realizar resúmenes numérico por grupos, en donde, para la función `numSummary` es cuestión de agregar el argumento `groups`, mientras que la función `describe`, debe ser reemplazada por la función `describeBy` y agregar en ésta el argumento `group`. Es de anotar, que para realizar el resumen por grupos, la variable que se usará para realizar el agrupamiento debe ser de tipo **factor**

```{r}
# Forma avanzada numSummary por grupos
numSummary(data = datos$`Yield (Quintal/ Hectare)`, groups = datos$Crop, statistics = c("mean", "sd", "se", "IQR", "quantiles", "cv", "skewness", "kurtosis"), type = "3", quantiles = c(0, .25, .5, .75, 1)) 

# Forma avanzada pysch por grupos
describeBy(x = datos$`Yield (Quintal/ Hectare)`, group = datos$Crop, ranges = TRUE, trim = 0.2, type = 3, quant = c(0.25, 0.75), IQR = TRUE)
```

## Resumen tabular
Una forma convencional de presentar resúmenes de variables cualitativas, es mediante la construcción de tablas de frecuencias, las cuales permiten presentar de forma individual algunas de las características que poseen las variables cualitativas, o permiten presentar de forma conjunta algunas de las características que comparten dichas variables.

Para presentar de forma individual o grupal las características de las variables, puede emplearse la función `table()` de la librería `base`, la cual agrega la información presentada en de las variables de una forma simple, que permite observar el número (frecuencia absoluta) de observaciones que comparten cierto atributo. Se aconseja que los datos usados dentro de la función `table()` sean de tipo *factor*.

Para ilustrar el manejo de esta funciones, se continua trabajando con la base de datos de [Agricultura de India](https://github.com/jiperezga/jiperezga.github.io/raw/master/Dataset/AgriculturaIndia.xlsx){:target="_blank".

```{r}
#  Creación de tabla de frecuencias absolutas en una vía
## Si el conjunto de observaciones tiene valores faltantes agregar el comando useNA = "ifany"
tabla1via <- table(datos$Crop) 
tabla1via

# Crear nueva variable
datos$catproduccion <- factor(ifelse(datos$`Yield (Quintal/ Hectare)` < 30, "Baja", "Alta"))
#  Creación de tabla de frecuencias absolutas en dos vía
tabla2vias <- table(datos$catproduccion, datos$State)
tabla2vias

# Agrega las sumas totales a la tabla de frecuencias absolutas por fila y/o columna
addmargins(tabla2vias, margin = c(1,2)) # margin = 1 en filas, margin = 2 en columnas
```

También es posible presentar los valores agregados, en forma de frecuencias relativas, mediante la función `prop.table(tabla)` de la librería `base` de <tt>R</tt>, donde `tabla` hace referencia a la tabla de frecuencias absolutas creada anteriormente.

```{r}
# Creación de tablas de frecuencias relativas en una vía
prop1via <- prop.table(tabla1via)
prop1via

#  Creación de tabla de frecuencias relativas en dos vía
prop2vias <- prop.table(tabla2vias)
prop2vias

# Agrega las sumas totales a la tabla de frecuencias relativas por fila y/o columna
addmargins(prop2vias, margin = c(1,2))
```

## Análisis gráfico
Otro aspecto importante del análisis descriptivo, es el que se realiza mediante análisis gráfico. El análisis gráfico es una forma de simplificar lo tedioso y complejo de un conjunto de observaciones, además de ser una forma más accesible de presentación de la información cuando se tienen muchas variables, puesto que permiten mostrar el comportamiento de los datos presentados, y hacer juicios respecto a su tendencia central, variabilidad, formas, patrones, tendencias, etc.

El análisis gráfico, puede ser dividido en diferentes clases

* Gráficos para una variable cuantitativa
* Gráficos para varias variables cuantitativas
* Gráficos para una o más variables cualitativas
* Gráficos para variables cuantitativas y cualitativas

Para ilustrar el manejo de los diferentes gráficos, la base de datos de [Agricultura de India](https://github.com/jiperezga/jiperezga.github.io/raw/master/Dataset/AgriculturaIndia.xlsx){:target="_blank"}, la cual contiene la información sobre la producción de cultivos agrícolas en la India.

### Gráficos para una variable cuantitativa
Entre las gráficos básicos que permiten realizar análisis cuantitativo para una variable se tiene, al diagrama de tallo y hojas, gráfico de caja y bigotes, histograma y densidad.

#### Diagrama de tallo y hojas
Este gráfico sirve como medida de resumen de los datos, brinda información de valores máximos, mínimos, área en donde más se centran los datos, dispersión. datos atípicos y asimetría. A pesar de toda la información que puede brindar esta gráfica, su uso es muy limitado, ya que en situaciones en las cuales el rango de la variable es muy grande, ésta no permite visualidad con claridad dichos comportamientos. Este gráfico puede ser realizado mediante la función `stem()` de la librería `graphics` de <tt>R</tt>.

```{r}
stem(datos$`Cost of Production (/ Quintal) C2`)
stem(datos$`Cost of Production (/ Quintal) C2`, scale = 4)
```

#### Gráfico de caja y bigotes (boxplot)
Este gráfico sirve para presentar de forma visual, datos numéricos a través de sus cuartiles, además de presentar otras  características importantes, tales como la dispersión, simetría y datos potencialmente atípicos.

La caja del gráfico contiene el 50% central de los datos (rango intercuartil), brinda información sobre la asimetría, `$Q_1$`, `$Q_2$` (mediana) y `$Q_3$`, el bigote inferior se calcula usualmente como `$Q_1–0.5*IQR$`,`$Q_1–IQR$`, o `$Q_1–1.5*IQR$` y el superior como `$Q3+0.5*IQR$`, `$Q3+IQR$` o `$Q3+1.5*IQR$`. Además, los valores que se encuentren por encima o debajo de los bigotes se consideran como potencialmente atípicos. Este gráfico puede ser realizado mediante la función `boxplot()` de la librería `graphics` de la base del <tt>R</tt>.

```{r}
boxplot(datos$`Cost of Production (/ Quintal) C2`, horizontal = T, xlab = "Costo", main = "Boxplot de Costo de Producción", col = "lightblue")
```

También puede agregarse el argumento `notch = TRUE`, lo cual hace que se grafique una muesca en cada lado de la caja, alrededor de la mediana. @Mcgill1978 señala que las muescas muestran un intervalo del 95% de confianza alrededor de la mediana, y que son construidas a partir de la ecuación
`\begin{align*}
\tilde{X}\pm C*s
\end{align*}`

siendo `$s$`, una aproximación asintótica gausiana de la desviación estándar de la mediana, la cual está dada por
`\begin{align*}
s=\frac{1.25*IQR}{1.35*\sqrt{n}}
\end{align*}`

y siendo `$C=1.7$` una constante, la cual es una selección empírica realizada por los autores.

```{r}
boxplot(datos$`Cost of Production (/ Quintal) C2`, horizontal = T, xlab = "Costo", main = "Boxplot de Costo de Producción con Bandas de Confianza ", col = "lightgreen", notch = T)
```

#### Histograma
Este gráfico muestra la distribución de frecuencia o densidades del grupo de observaciones, brinda información sobre el valor más probables, la dispersión, la asimetría y valores extremos. Adicionalmente, tiene la ventaja de que su interpretación es muy intuitiva y por tanto es de los gráficos más preferidos para resumir información. Este gráfico puede ser realizado mediante la función `hist()` de la librería `graphics` de la base del <tt>R</tt>.

```{r}
hist(datos$`Cost of Production (/ Quintal) C2`, main = "Histograma de Costos de Producción", xlab = "Costos", col = "lightblue", freq = T) # Para gráfico con valor de densidades escribir freq = FALSE
```

#### Densidad
Este gráfico funciona similar al histograma de densidades, con la diferencia de que en lugar de mostrar la distribución mediante clases (barras), éste muestra el comportamiento de la distribución de las observaciones mediante una curva. Dicha curva, brinda mayor información que el histograma respecto al valor promedio, dispersión y asimetría. Este gráfico puede ser realizado mediante las funciones `plot(density())`, siendo `plot()` una función de la librería `graphics` y `density()` una función de la librería `stats`. Adicionalmente se presenta la función `polygon` de la librería `graphics`, la cual sirve para generar formas, o en este caso, darle color a la densidad 

```{r}
plot(density(datos$`Cost of Production (/ Quintal) C2`), main = "Densidad de Costos de Producción", xlab = "Costos", lwd = 2) # gráfica la densidad
polygon(density(datos$`Cost of Production (/ Quintal) C2`), col = "lightblue") # Colorea la densidad
```

### Gráficos para varias variables cuantitativa
Entre las gráficos básicos que permiten realizar análisis cuantitativo para varias variables se tiene, el gráfico de dispersión cuando se tienen solo dos variables y la matriz de dispersión cuando se tienen más de dos variables.

#### Gráfico de dispersión
Este gráfico se emplea para hacer cruces entre dos variables cuantitativas, y sirve para ver tendencias y relaciones entre dos variables cuantitativas, además de permitir apreciar donde se centra el total de observaciones dados dos atributos cuantitativos. Este gráfico puede ser realizado mediante la función `plot()` de la librería `graphics` de la base del <tt>R</tt>.
```{r}
plot(x = datos$`Cost of Cultivation (/ Hectare) C2`, y = datos$`Yield (Quintal/ Hectare)`, xlab = "Costos de Cultivo",
     ylab = "Producción", main = "Gráfica de interés :D", pch = 19)
```

#### Matriz de dispersión
Cuando se poseen más de dos variables cuantitativas, es posible presentar un matriz que muestre el cruce entre pares de variables, mediante cuadros con versiones simples de la función `plot()`. Este gráfico puede ser realizado mediante la función `pairs()` de la librería `graphics` de la base de <tt>R</tt>.

```{r}
### Se crea nueva variable para observar el comportamiento de la función pairs
set.seed(1532) # Crea una semilla que permite replicar la simulación de valores de rnorm
utilidad <- 140 * datos$`Yield (Quintal/ Hectare)` - 10 * datos$`Cost of Production (/ Quintal) C2` * rgamma(n = 63, shape = 54, rate = 26)

### Se crea matriz de variables a gráficar
mvari <- cbind(datos$`Yield (Quintal/ Hectare)`, datos$`Cost of Production (/ Quintal) C2`, utilidad)
pairs(mvari, labels = c("Producción", "Costos de Producción", "Utilidad"))
```

Funciones complementarias pueden ser desarrolladas para mejorar la visualización los pares de variables. En el libro de @Hernandez2018[, pp. 40-49], se presentan diferentes funciones que pueden ser implementadas. Entre ellas

```{r}
# Función para dibujar la dispersión y agregar la recta de regresión
panel.reg <- function (x, y)
{
  points(x, y, pch=20)
  abline(lm(y ~ x), lwd=2, col='dodgerblue2')
}
# Función para crear el histograma
panel.hist <- function(x, ...)
{
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(usr[1:2], 0, 1.5) )
  h <- hist(x, plot = FALSE)
  breaks <- h$breaks; nB <- length(breaks)
  y <- h$counts; y <- y/max(y)
  rect(breaks[-nB], 0, breaks[-1], y, col="dodgerblue2", ...)
}
# Función para obtener la correlación
panel.cor <- function(x, y, digits=2, prefix="", cex.cor)
{
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(0, 1, 0, 1))
  r <- abs(cor(x, y))
  txt <- format(c(r, 0.123456789), digits=digits)[1]
  txt <- paste(prefix, txt, sep="")
  if(missing(cex.cor)) cex <- 0.8/strwidth(txt)
  text(0.5, 0.5, txt, cex = cex * r)
}

pairs(mvari, labels = c("Producción", "Costos de Producción", "Utilidad"),
      upper.panel = panel.reg,
      diag.panel = panel.hist,
      lower.panel = panel.cor)
```

### Gráficos para variables cualitativas
Entre las gráficos básicos que permiten realizar análisis cualitativo para variables se tiene, el gráfico de barras, gráfico pareto, gráfico de pastel, y gráfico de puntos.

#### Gráfico de barras
Sirve para resumir variables cualitativas mediante barras de frecuencias absolutas o relativas. Éste permite observar la concentración de observaciones en una o más categorías diferentes. Este gráfico puede ser realizado mediante la función `barplot()` de la librería `graphics` de <tt>R</tt>, usando como insumo, tablas de frecuencias absolutas o relativas.

```{r}
# Usando las tablas de frecuencias absolutas presentadas en el análisis tabular.
barplot(tabla1via, main = "Frecuencias absolutas de los Estados", col = rainbow(10)) 
barplot(prop1via, main = "Frecuencias relativas de los Estados", col = rainbow(20))
```

Este gráfico también puede ser empleado para realizar el cruce de dos o más variables cualitativas

```{r}
# Usando las tablas cruzadas de frecuencias absolutas presentadas en el análisis tabular.
barplot(tabla2vias, main = "Frecuencias absolutas categorías de producción por Estado", col = c("lightblue", "lightgreen"), las = 2) 
barplot(prop2vias, main = "Frecuencias relativa categorías de producción por Estado", col = c("lightblue", "lightgreen"), beside = T, las = 2)
legend("topright", rownames(prop2vias), fill = c("lightblue", "lightgreen")) 
```

#### Gráfico de pareto
Este gráfico es similar al gráfico de barras para una sola variable cualitativa, pero con la ventaja de que presenta las frecuencias absolutas, relativas, y las frecuencias acumuladas absolutas y acumuladas relativas en el mismo gráfico. Este gráfico puede ser realizado mediante la función `pareto.chart()` de la librería `qqc`, usando como insumo, tablas de frecuencias absolutas o relativas.

```{r}
# install.packages("qcc") # Instala paquete qcc
library(qcc) # Carga paquete qcc
# Usando las tablas de frecuencias absolutas presentadas en el análisis tabular.
pareto.chart(tabla1via, las = 2, main = "Gráfico Pareto para los Estados")
```

#### Gráfico de pastel
Este gráfico también sirve para representar gráficamente las tablas de frecuencias absolutas y relativas para una variable cualitativa. A pesar de ser un gráfico muy usado en la práctica, no muestra bien la información que se desea presentar, ya que siempre debe estar acompañado de los porcentajes o frecuencias dentro de cada área, ya que no hacerlo, dicho gráfico puede ser muy engañoso. Este gráfico puede ser realizado mediante la función `pie()` de la librería `graphics` de <tt>R</tt>, usando como insumo, tablas de frecuencias absolutas o relativas.

```{r}
# Usando las tablas de frecuencias relativas presentadas en el análisis tabular.
pie(prop1via, main = "Frecuencia Relativa por Estados", col = rainbow(20))
legend("topleft", legend = round(prop1via,4), fill = rainbow(20))
```

#### Gráfico de puntos
Este gráfico también es similar al gráfico de barras, sirve para presentar la frecuencia de una variable cualitativa o un cruce de dos variables cualitativas, y muestra un punto que representa el conteo del total de observaciones que hay para cada variable. Este gráfico puede ser realizado mediante la función `dotchart()` de la librería `graphics` de <tt>R</tt>, usando como insumo, tablas de frecuencias absolutas o relativas.

```{r}
# Usando las tablas de frecuencias absolutas presentadas en el análisis tabular.
## Gráfico para una sola variable cualitativa
dotchart(tabla1via, main = "Frecuencias absolutas de Estados")
## Gráfico para el cruce de dos variables cualitativas
dotchart(tabla2vias, main = "Frecuencias absolutas de categorías de producción por Estados")
```

### Gráficos para variables cuantitativas y cualitativas
Entre las gráficos básicos que permiten analizar los cruces entre variables cuantitativas y cualitativas se tiene, al gráfico de caja y bigotes, gráfico de medias, histogramas, densidades, diagrama de dispersión.

#### Gráfico de caja y bigotes
Este gráfico sirve para presentar de forma visual, datos numéricos por categorías a través de sus cuartiles, además de presentar otras características importantes, tales como la dispersión, simetría y datos potencialmente atípicos. Este gráfico puede ser realizado mediante la función `boxplot()` de la librería `graphics` de <tt>R</tt>.

```{r}
boxplot(datos$`Cost of Production (/ Quintal) C2` ~ datos$Crop, horizontal = T, xlab = "Costos", ylab = "", main = "Costos de Producción por tipo de cosecha", col = rainbow(10), las = 1)
```

También puede agregarse el argumento `notch = TRUE`, lo cual hace que se grafique una muesca en cada lado de la caja, alrededor de la mediana. Además, si las muescas de dos parcelas no se superponen, entonces se tendrá evidencia sólida respecto a que la mediana de los grupos es diferente [@Chambers1983, p. 62].

```{r}
boxplot(datos$`Cost of Production (/ Quintal) C2` ~ datos$Crop, horizontal = T, xlab = "Costos", ylab = "", main = "Costos de Producción por tipo de cosecha", col = rainbow(10), las = 1, notch = T)
```

#### Gráfico de medias
Este gráfico sirve para presentar de forma visual, grupos de datos numéricos a través de sus media y desviación estándar. El gráfico está compuesto por un punto que representa el valor promedio del grupo de observaciones y las barras representan **una** desviación estándar de la media. Este gráfico puede ser realizado mediante la función `plotMeans()` de la librería `RcmdrMisc`.

```{r}
library(RcmdrMisc) # Carga la librería RcmdrMisc
# recordar escribir en error.bars = "sd" porque por defecto se presenta el error estándar y no la desviacion estándar.
plotMeans(response = datos$`Cost of Production (/ Quintal) C2`, factor1 = datos$Crop, error.bars = "sd", xlab = "Costos de Producción", ylab = "Cosecha")
```


#### Histograma
Este gráfico muestra la distribución de frecuencia o densidades de dos o más grupos de observaciones, brinda información sobre de los valores más probables, las dispersiones, las asimetrías y valores extremos. Este gráfico puede ser realizado mediante la función `hist()` de la librería `graphics` de <tt>R</tt>. Para agregar más histograma en la misma gráfico, es necesario agregar el argumento `add = TRUE`.

```{r}
mini <- min(datos$`Cost of Cultivation (/ Hectare) C2`)
maxi <- max(datos$`Cost of Cultivation (/ Hectare) C2`)
hist(datos$`Cost of Cultivation (/ Hectare) C2`[datos$Crop == "ARHAR"], main = "Costos de Cultivo por Tipo de Cultivo", xlab = "Costos de Cultivo", col = "lightblue", freq = T, breaks = 6, xlim = c(10000, 30000)) 
hist(datos$`Cost of Cultivation (/ Hectare) C2`[datos$Crop == "GRAM"], col = "lightblue4", freq = T, add = T, breaks = 6) 
legend("topleft", legend = c("ARHAR", "GRAM"), fill = c("lightblue", "lightblue4"))
```

dado que no es posible observar bien la diferencia entre variables con el histograma, cuando se emplea el paquete base, es posible usar librerías que permitan gráficos más avanzados, tales como los creados mediante la función `ggplot` de la librería `ggplot2`.

```{r}
# install.packages("ggplot2") # instala paquete ggplot2
library(ggplot2)
# Se organiza base de datos para poder ser leida
BD <- data.frame(Costos = c(datos$`Cost of Cultivation (/ Hectare) C2`[datos$Crop == "ARHAR"], datos$`Cost of Cultivation (/ Hectare) C2`[datos$Crop == "GRAM"]), Clase = c(rep("ARHAR", 10), rep ("GRAM", 8)))

ggplot(BD, aes(x=Costos, fill=Clase)) + geom_histogram(alpha=0.7,colour=1, bins = 6, position="identity") + theme_bw()+ylab("Frecuencia") + xlab("Costos de Cultivo") + ggtitle("Costos de Cultivo por Categoría de Producción")
```

Es de anotar que también puede cambiar la forma en que se agrupan los datos en cada una de las categorías, y por tanto, puede verse diferencias entre el gráfico realizado con el paquete base y el gráfico realizado con el paquete ggplot.

#### Densidad
Este gráfico muestra el comportamiento de la distribución de las observaciones mediante una curva de densidad para cada una de las variables. Este gráfico, brinda información respecto al valor promedio, dispersión y asimetría. Este gráfico puede ser realizado mediante las funciones `plot(density())`, siendo `plot()` una función de la librería `graphics` y `density()` una función de la librería `stats`. Para realizar el segundo gráfico, se debe emplear la función `lines(density())`, siendo `lines()` una función de la librería `graphics`.

```{r}
plot(density(datos$`Cost of Production (/ Quintal) C2`[datos$Crop == "GRAM"]), main = "Costos de Producción", xlab = "Costos", lwd = 2, xlim = c(1000, 4500)) # gráfica la densidad
lines(density(datos$`Cost of Production (/ Quintal) C2`[datos$Crop == "ARHAR"]), col = "red", lwd = 2)
legend("topright", legend = c("GRAM", "ARHAR"), col = c("black", "red"), lwd = 2)
```

#### Gráfico de dispersión
Este gráfico se emplea para hacer cruces entre dos variables cuantitativas y diferenciarlas por una cualitativa. Este sirve para ver tendencias, diferencias entre clases, relaciones entre dos variables cuantitativas, y permite apreciar donde se centra el total de observaciones dados dos atributos cuantitativos. Este gráfico puede ser realizado mediante la función `plot()` de la librería `graphics` de <tt>R</tt>.

```{r}
plot(x = datos$`Yield (Quintal/ Hectare)`, y = datos$`Cost of Cultivation (/ Hectare) C2`, xlab = "Producción",
     ylab = "Costos de Cultivo", main = "Poriducción vs Costos de Cultivo", pch = 19, col = datos$catproduccion)
legend("bottomright", legend = levels(datos$catproduccion), col = 1:4, pch = 19)
```

## Bibliografía


