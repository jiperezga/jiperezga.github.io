---
layout: presentation
title: "Sesion 01"
main-class: 'presentaciones'
permalink: /MaestriaPoliticasPublicas/MaesPolPub:title.html
tags:

introduction: Estadística Descriptiva
image: <img src="../../assets/images/logoUdeA.png" alt="UdeA" class="sticky">
header-includes:
   - \usepackage{amsmath,amssymb,amsthm,amsfonts}
   - \usepackage[sectionbib]{natbib}
   - \usepackage[hidelinks]{hyperref}
output:
  md_document:
    variant: markdown_strict+backtick_code_blocks+autolink_bare_uris+ascii_identifiers+tex_math_single_backslash
    preserve_yaml: TRUE
always_allow_html: yes   
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding,
  output_dir = "../../MaestriaPoliticasPublicas/_posts/", output_format = "all"  ) })
bibliography: "../../referencias.bib"
csl: "../../apa.csl"
link-citations: yes
---

```{r knitr_init, echo=FALSE, cache=FALSE}
library(knitr)
## Global options
opts_chunk$set(echo=TRUE,
               cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE,
               fig.path = paste0("../../MaestriaPoliticasPublicas/images/", "SesionEsp01"),
               cache.path = "../../MaestriaPoliticasPublicas/cache/",
               cache = FALSE)
```




### Análisis gráfico
Otro aspecto importante del análisis descriptivo, es el que se realiza mediante análisis gráfico. **El análisis gráfico es una forma de simplificar lo tedioso y complejo de un conjunto de observaciones**, además de ser una forma más accesible de presentación de la información cuando se tienen muchas variables, puesto que permiten mostrar el comportamiento de los datos presentados, y hacer juicios respecto a su tendencia central, variabilidad, formas, patrones, tendencias, etc.

El análisis gráfico, puede ser dividido en  

* Gráficos para variables cuantitativa
* Gráficos para variables cualitativas
* Gráficos para cruces entre variables cuantitativas y cualitativas

En la siguiente tabla se hace un resumen de qué gráficos pueden ser apropiados para usar en cada uno de los casos

```{r echo=FALSE, eval=F}
library(kableExtra)

tablita <- cbind(
  c("Gráfico de caja y bigotes", "Diagrama de dispersión", "Matriz de dispersión",
    "Gráfico de barras", "Gráfico de barras", "Gráfico de caja y bigotes"),
  c("Histograma", "", "", "Gráfico de pareto", "Gráfico de balón", "Gráfico de medias"),
  c("Densidad", "", "", "Gráfico de pastel", "", ""))

rownames(tablita) <- c("Una Cuantitativa", "Dos Cuantitativa", "Más de Dos Cuantitativas",
                       "Una Cualitativa", "Dos Cualitativas", "Cualitativa - Cuantitativa")
kable(tablita, 
  format = "html", booktabs = T, col.names = NULL) %>%
kable_styling("striped", full_width = F)
```

<pre style="font-family: 'Open Sans',sans-serif; margin-bottom: -3rem; margin-top: -3rem; font-size: 120%;"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;"><thead>
  <tr>
   <th style="text-align:left;"> Categoría</th>
   <th style="text-align:left; text-align: center" colspan="3"> Tipo de Gráficos </th>
  </tr>
 </thead>
<tbody>
<tr>
<td style="text-align:left;"> <a href="http://jiperezga.github.io/MaestriaPoliticasPublicas/SesionEsp01#una-variable-cuantitativa" style="
    color: #ffffff;
"><b><u>Una Cuantitativa</u></b></a></td>
<td style="text-align:left;">Gráfico de caja y bigotes</td>
<td style="text-align:left;">Histograma</td>
<td style="text-align:left;">Densidad</td>
</tr>
<tr>
<td style="text-align:left;"> <a href="https://jiperezga.github.io/MaestriaPoliticasPublicas/SesionEsp01#dos-variables-cuantitativas" style="
    color: #ffffff;
"><b><u>Dos Cuantitativas</u></b></a></td>
<td style="text-align:left;">Diagrama de dispersión</td>
<td style="text-align:left;"></td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;"> <a href="https://jiperezga.github.io/MaestriaPoliticasPublicas/SesionEsp01#más-de-dos-variables-cuantitativas" style="
    color: #ffffff;
"><b><u>Más de Dos Cuantitativas</u></b></a></td>
<td style="text-align:left;">Matriz de dispersión</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;"> <a href="https://jiperezga.github.io/MaestriaPoliticasPublicas/SesionEsp01#una-variable-cualitativa" style="
    color: #ffffff;
"><b><u>Una Cualitativa</u></b></a></td>
<td style="text-align:left;">Gráfico de barras
</td>
<td style="text-align:left;">Gráfico de pareto
</td>
<td style="text-align:left;">Gráfico de pastel
</td>
</tr>
<tr>
<td style="text-align:left;"> <a href="https://jiperezga.github.io/MaestriaPoliticasPublicas/SesionEsp01#dos-variables-cualitativas" style="
    color: #ffffff;
"><b><u>Dos Cualitativas</u></b></a></td>
<td style="text-align:left;">Gráfico de barras</td>
<td style="text-align:left;">Gráfico de balón</td>
<td style="text-align:left;"></td>
</tr>
<tr>
<td style="text-align:left;"> <a href="https://jiperezga.github.io/MaestriaPoliticasPublicas/SesionEsp01#cruce-entre-variables-cualitativas-y-cuantitativas" style="
    color: #ffffff;
"><b><u>Cualitativa - Cuantitativa</u></b></a></td>
<td style="text-align:left;">Gráfico de caja y bigotes</td>
<td style="text-align:left;">Gráfico de medias</td>
<td style="text-align:left;"></td>
</tr>
</tbody>
</table></pre>


#### Una variable Cuantitativa

**Gráfico de caja y bigotes**<br><br>
Este gráfico sirve para presentar de forma visual, datos numéricos a través de sus cuartiles, además de presentar otras **características importantes, tales como el valor de los cuartiles, dispersión, simetría y datos potencialmente atípicos**.

<h4 align="center"> Representación de un Gráfico de Caja y Bigotes </h4>
![](../EstadisticaI/images/BoxPlot.jpg)

Este gráfico puede ser realizado mediante la función <tt>boxplot()</tt> de la librería <tt>graphics</tt> de la base del <tt>R</tt>. 

Suponga que se desea presentar de forma visual, el comportamiento de la variable que corresponde al grado de avance de la obra en contrucción (<tt>gradoavanc</tt>) a partir de el comportamiento de los cuartiles. Para ello, podemos emplear la función <tt>boxplot()</tt> de la forma

```{r}
# Construcción de gráfico de caja y bigotes
boxplot(datos$gradoavanc, horizontal = T, xlab = "Porcentaje de avance (%)", main = "Boxplot del Grado de Avance de la Obra", col = "lightblue")
```

**Histograma**<br><br>
Este gráfico muestra la distribución de frecuencia o densidades del grupo de observaciones, **brinda información sobre el valor más probables, la dispersión, la asimetría y valores extremos**. Adicionalmente, tiene la ventaja de que su interpretación es muy intuitiva y por tanto es de los gráficos más preferidos para resumir información. Este gráfico puede ser realizado mediante la función <tt>hist()</tt> de la librería <tt>graphics</tt> de la base del <tt>R</tt>.

Suponga que se desea presentar mediante un histograma, el comportamiento de la variable que corresponde al precio de venta por `$m^2$` del inmueble (<tt>preciovtax</tt>). Para ello, podemos emplear la función <tt>hist()</tt> de la forma

```{r}
## Construcción de histograma
hist(datos$preciovtax, main = "Histograma del Precio de venta por M2", xlab = "Precio (en miles de pesos)", col = 8) 
```

**Densidad**<br><br>
Este gráfico funciona similar al histograma de densidades, con la diferencia de que en lugar de mostrar la distribución mediante clases (barras), éste muestra el comportamiento de la distribución de las observaciones mediante una curva. Dicha curva, **brinda mayor información que el histograma respecto al valor promedio, dispersión y asimetría**. Este gráfico puede ser realizado mediante la combinación de las funciones <tt>plot()</tt> y <tt>density()</tt>, de la forma <tt>plot(density())</tt>, siendo <tt>plot()</tt> y <tt>density()</tt> funciones de las librerías <tt>graphics</tt> y <tt>stats</tt> de la base de <tt>R</tt>. 

Adicionalmente se presenta la función <tt>polygon</tt> de la librería <tt>graphics</tt> de la base de <tt>R</tt>, la cual sirve para generar formas, o en este caso, darle color a la densidad.

Suponga que se desea presentar la densidad, de la variable que corresponde al área total vendible por unidad (<tt>areavenuni</tt>). Para ello, podemos emplear la función <tt>hist()</tt> de la forma

```{r}
## Construcción de la densidad
plot(density(datos$areavenuni, na.rm = T), main = "Gráfico de Densidad para Area Total Vendible", xlab = "Área Total Vendible", lwd = 2) 
# Colorea la densidad
polygon(density(datos$areavenuni, na.rm = T), col = 3) 
```

#### Dos variables Cuantitativas

**Gráfico de dispersión**<br><br>
Este gráfico se emplea para hacer cruces entre dos variables cuantitativas, y **sirve para ver tendencias y relaciones entre dos variables cuantitativas, además de permitir apreciar donde se centra el total de observaciones, y detección de datos atípicos** dados dos atributos cuantitativos. Este gráfico puede ser realizado mediante la función <tt>plot()</tt> de la librería <tt>graphics</tt> de la base del <tt>R</tt>.

Para entender la forma en que se aplica un diagrama de dispersión, suponga que se quiere observar, si éxiste alguna relación entre el área del lote donde se construye la obra o proyecto (<tt>area_lote</tt>) y el precio de venta por `$m^2$` (<tt>preciovtax</tt>). Para ello, podemos emplear la función <tt>plot()</tt> de la forma.

```{r}
plot(x = datos$area_lote, y = datos$preciovtax, xlab = "Área del Lote",
     ylab = "Precio de venta (m2)", main = "Relación entre Área del Lote y Precio de venta m2", pch = 19)
```

#### Más de dos variables Cuantitativas

**Matriz de dispersión**<br><br>
Cuando se poseen más de dos variables cuantitativas, es posible presentar un matriz que muestre el cruce entre pares de variables, mediante cuadros con versiones simples de la función <tt>plot()</tt>. Este gráfico puede ser realizado mediante la función <tt>pairs()</tt> de la librería <tt>graphics</tt> de la base de <tt>R</tt>.

Para ello, suponga que se desea observar la relación que hay entre las variables, área del lote donde se construye la obra o proyecto (<tt>area_lote</tt>), porcentaje de avance de la obra en contrucción (<tt>gradoavanc</tt>) y área total vendible por unidad (<tt>areavenuni</tt>). Para ello empleamos la función <tt>pairs()</tt> de la forma
```{r}
## Matríz de dispersión básica
pairs(cbind(datos$area_lote, datos$gradoavanc, datos$areavenuni), labels = c("Área Lote", "Porcentaje de Avance", "Área Total Vendible"))
```

Funciones complementarias pueden ser desarrolladas para mejorar la visualización los pares de variables. En el libro de @Hernandez2018[, pp. 40-49], se presentan diferentes funciones que pueden ser implementadas. Entre ellas la siguiente función

```{r}
## Matríz de dispersión avanzada
# Función para dibujar la dispersión y agregar la recta de regresión
panel.reg <- function(x, y)
{
  points(x, y, pch=20)
  abline(lm(y ~ x), lwd=2, col='dodgerblue2')
}
# Función para crear el histograma
panel.hist <- function(x, ...)
{
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(usr[1:2], 0, 1.5) )
  h <- hist(x, plot = FALSE)
  breaks <- h$breaks; nB <- length(breaks)
  y <- h$counts; y <- y/max(y)
  rect(breaks[-nB], 0, breaks[-1], y, col="dodgerblue2", ...)
}
# Función para obtener la correlación
panel.cor <- function(x, y, digits=2, prefix="", cex.cor)
{
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(0, 1, 0, 1))
  r <- abs(cor(x, y))
  txt <- format(c(r, 0.123456789), digits=digits)[1]
  txt <- paste(prefix, txt, sep="")
  if(missing(cex.cor)) cex <- 0.8
  text(0.5, 0.5, txt, cex = cex)
}

pairs(cbind(datos$area_lote, datos$gradoavanc, datos$areavenuni), labels = c("Área Lote", "Porcentaje de Avance", "Área Total Vendible"), upper.panel = panel.reg, diag.panel = panel.hist, lower.panel = panel.cor)
```

#### Una Variable Cualitativa

**Gráfico de barras**<br><br>
Sirve para resumir una variable cualitativa mediante barras de frecuencias absolutas o relativas. Éste **permite observar la concentración de observaciones en una o más categorías diferentes**. Este gráfico puede ser realizado mediante la función <tt>barplot()</tt> de la librería <tt>graphics</tt> de la base de <tt>R</tt>.

Para ilustrar su empleo, suponga que se desea observar el estado en el cual se encontraron las obras al momento de realizar el censo (<tt>estado_act</tt>). En este caso, la función <tt>barplot()</tt> se emplea de la siguiente forma

```{r}
# Gráfico de barras
tabla1 <- table(datos$estado_ac)
barplot(tabla1, main = "Estado en el cual se encontraron las obras al momento del censo", col = hcl.colors(6)) 
```

**Gráfico de pareto**<br><br>
Este gráfico es similar al gráfico de barras para una sola variable cualitativa, pero con la ventaja de que **presenta las frecuencias absolutas, relativas, y las frecuencias acumuladas absolutas y acumuladas relativas en el mismo gráfico**. Este gráfico puede ser realizado mediante la función <tt>pareto.chart()</tt> de la librería <tt>qqc</tt>.

Para ilustrar su empleo, suponga que se desea observar el estrato socioeconómico en donde se está realizado la obra (<tt>estrato</tt>). Al ser una sola variable, la función <tt>pareto.chart()</tt> se emplea de la siguiente forma

```{r}
library(qcc)

# Gráfico de pareto
tabla2 <- table(datos$estrato)
pareto.chart(tabla2, main = "Gráfico Pareto por Estrato")
```

**Gráfico de pastel**<br><br>
Este gráfico también **sirve para representar gráficamente las tablas de frecuencias absolutas y relativas para una variable cualitativa**. A pesar de ser un gráfico muy usado en la práctica, **no muestra bien la información que se desea presentar**, ya que siempre debe estar acompañado de los porcentajes o frecuencias que representa cada área, ya que no hacerlo, dicho gráfico puede ser muy engañoso. 

Este gráfico puede ser realizado mediante la función <tt>pie()</tt> de la librería <tt>graphics</tt> de la base de <tt>R</tt>, y donde, para establecer etiquetas de los porcentajes o frecuencias de cada área, puede establecerse mediante la función <tt>legend()</tt> de la librería <tt>graphics</tt> de la base de <tt>R</tt>.

Empleamos la variable del estado en que se encuentra la obra (<tt>movimiento</tt>) para ilustrar el empleo del gráfico de pastel. En dicho caso, la estructura de la función <tt>pie()</tt> y <tt>legend()</tt> será de la forma

```{r}
# Gráfico de pastel una variable de frecuencias absolutas
tabla3 <- prop.table(table(datos$movimiento))
pie(tabla3, main = "Estado en que se encuentra la obra", col = cm.colors(6))
legend("topleft", legend = paste0(names(tabla3), " (", round(tabla3,4), ")"), fill = cm.colors(6), cex = 0.8)
```

#### Dos Variables Cualitativas

**Gráfico de barras**<br><br>
El gráfico de barras también sirve para resumir dos variable cualitativa mediante barras de frecuencias absolutas o relativas. **La interpretación, será la misma que para una sola variable cualitativa, con la diferencia de que en este caso, se podrán hacer comparaciones por categorías adicionales.** Este gráfico puede ser realizado mediante la función <tt>barplot()</tt> de la librería <tt>graphics</tt> de la base de <tt>R</tt>, junto a la función <tt>legend()</tt>, para establecer las etiquetas asociadas a cada una de las barras que se presenten en el gráfico.

Para ilustrar su empleo, suponga que se desea observar el estado en el cual se encontraron las obras al momento de realizar el censo (<tt>estado_act</tt>), respecto a si la obra cuenta o no con licencia (<tt>ob_formal</tt>). En este caso, la función <tt>barplot()</tt> se emplea junto a la función <tt>legend()</tt> de la siguiente forma

```{r}
# Gráfico de barras
tabla4 <- table(datos$estado_ac, datos$ob_formal)
barplot(tabla4, main = "Estado de la obra respecto a si la obra cuenta o no con licencia", col = hcl.colors(6), beside = T) 
legend("topright", rownames(tabla4), fill = topo.colors(6), cex = 0.8) 
```

**Gráfico de balón**<br><br>
El gráfico de balón, suele ser un gráfico más avanzado para resumir dos variable cualitativa, en donde **se establecen en el cruce de las dos variables, círculos que se asocian al tamaño del cruce de las dos variables cualitativas**. Este gráfico puede ser realizado mediante la función <tt>ggballoonplot()</tt> de la librería <tt>ggpubr</tt>, la cual depende de la librería <tt>ggplot2</tt>.

Para ilustrar el empleo de la función, suponga que se desea observar el estado en el cual se encontraron las obras al momento de realizar el censo (<tt>estado_act</tt>), respecto al estado en que se encuentra la obra (<tt>movimiento</tt>). En este caso, la función <tt>ggballoonplot()</tt> puede emplearse de la forma

```{r}
library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())

# Gráfico de balón
tabla5 <- data.frame(table(datos$estado_ac, datos$movimiento))
ggballoonplot(tabla5, fill = "value")+
  scale_fill_viridis_c(option = "C")
```

#### Cruce entre Variables Cualitativas y Cuantitativas

**Gráfico de caja y bigotes**<br><br>
Este gráfico sirve para presentar de forma visual, datos numéricos **por categorías** a través de sus cuartiles, además de presentar **otras características importantes, tales como la dispersión, simetría y datos potencialmente atípicos**. Este gráfico puede ser realizado mediante la función <tt>boxplot()</tt> de la librería <tt>graphics</tt> de <tt>R</tt>.

Suponga que se tiene interés en realizar un cruce entre la variable cualitativa que indica si la obra cuenta o no con licencia (<tt>ob_formal</tt>) y la variable cuantitativa del grado de avance de la obra (<tt>gradoavanc</tt>). Para ello, puede emplearse el gráfico de caja y bigotes de la forma
```{r}
# Construcción de gráfico de caja y bigotes por categorías
boxplot(datos$gradoavanc ~ datos$ob_formal, horizontal = T, xlab = "Grado de avance", ylab = "Posee licencia?", main = "Grado de avance respecto a la posesión de licencia", col = terrain.colors(2))
```

**Gráfico de medias**<br><br>
Este gráfico **sirve para presentar de forma visual, grupos de datos numéricos a través de sus media y desviación estándar**. El gráfico está compuesto por un punto que representa el valor promedio del grupo de observaciones y **las barras representan dos desviación estándar de la media**. En donde, si las barras no se superponen, entonces se tendrá evidencia sólida respecto a que la media de los grupos es diferente.

Este gráfico puede ser realizado mediante la función <tt>plotMeans()</tt> de la librería <tt>RcmdrMisc</tt>. Y para ilustrar su empleo, suponga que se desea observar área total vendible (<tt>areavendib</tt>), respecto al rango de vivienda calculado (<tt>ranvivi</tt>). Ésto se puede realizar mediante la forma

```{r}
library(RcmdrMisc)

## Construcción de diagrama de caja y bigotes por categorías
# Recordar escribir en error.bars = "conf.int" porque por defecto se presenta un intervalo para el error estándar y no para dos desviaciones estándar.
plotMeans(response = datos$areavendib, factor1 = datos$ranvivi, error.bars = "conf.int", xlab = "Área total vendible", ylab = "Rangos de vivienda", main = "Área vendible respecto a rangos de vivienda")
```


## Referencias
<h7 id="ref-    2016"></h7>
<h7 id="ref-Hernandez2018"></h7>
<h7 id="ref-Recchioni2016"></h7>



